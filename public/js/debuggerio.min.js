/**
 * debugger.io: An interactive web scripting sandbox
 *
 * https://github.com/gavinhungry/debugger.io
 *
 * Copyright (C) 2013 Gavin Lloyd <gavinhungry@gmail.com>
 * This is free software distributed under the terms of the MIT license
 */

define("jquery",["jqueryjs","ui","transit","nano"],function(e,t,n,r){return e.support.transition||(e.fn.transition=e.fn.animate),e}),define("underscore",["underscorejs","string","inflection"],function(e,t,n){return e.mixin(t.exports()),e}),define("config",["jquery","underscore"],function(e,t){var n={},r=window.location.hostname,i={debug:!0,default_theme:"dark",panel_min:52,cdn_results:32,cdn_height:219,layout_time:300,github:"https://github.com/gavinhungry/debugger.io",root:t.sprintf("//%s/",r),frame:t.sprintf("//frame.%s/",r)};return n.option=function(e,r){if(n.hasOwnProperty(e))return;var s=t.isBoolean(r);Object.defineProperty(n,e,{get:function(){var n=i[e],r=t.isFunction(n);return r?s?!!n():n():n},set:function(n){var r=t.isFunction(n);i[e]=s&&!r?!!n:n}}),n[e]=r},t.each(i,function(e,t){n.option(t,e)}),n.debug&&(window.config=n),n}),define("utils",["config","jquery","underscore"],function(e,t,n){var r={};e.debug&&(window.utils=r),r.log=function(){if(e.debug){var t=n.toArray(arguments);t.unshift("==>"),console.log.apply(console,t)}},r.ensure_jquery=function(e){return e instanceof t?e:e instanceof HTMLElement||n.isArray(e)?t(e):t()},r.ensure_array=function(e){return e===undefined||e===null?[]:n.isArray(e)?e:[e]},r.ensure_string=function(e){return n.isString(e)?e:e?e+"":""},r.module=function(t,n,r){var i=n||{};i._priv=i._priv||{};if(r||r===undefined&&e.debug)window[t]=i;return i},r.no_quotes=function(e){return n.isString(e)?e.replace(/\"/g,""):""},r.uri=function(t){return e.root+t},r.extension=function(e){return e=n.trim(r.no_quotes(e)),n.strRightBack(e,".")},r.script_element_string=function(e,t){return e=n.trim(r.no_quotes(e)),t=t||i.js.type,n.sprintf('<script type="%s" src="%s"></script>',t,e)},r.style_element_string=function(e,t){return e=n.trim(r.no_quotes(e)),t=t||i.css.type,n.sprintf('<link rel="stylesheet" type="%s" href="%s">',t,e)};var i={js:{tag:"script",type:"application/javascript",fn:r.script_element_string},css:{tag:"link",type:"text/css",fn:r.style_element_string}};return r.resource_tag=function(e){var t=r.extension(e),n=i[t];return n?n.tag:null},r.resource_element_string=function(e){var t=r.extension(e),n=i[t];return n?n.fn(e,n.type):null},r.promise_now=function(e){return t.Deferred().resolve(e).promise()},r.clamp=function(e,t,r){return e=n.isFinite(e)?e:0,t=n.isFinite(t)?t:Number.NEGATIVE_INFINITY,r=n.isFinite(r)?r:Number.POSITIVE_INFINITY,Math.min(Math.max(e,t),r)},r.Buffer=function(e){this._data=[],this.set_cap(e)},r.Buffer.prototype={buf:function(){return n.each(arguments,function(e){this._data.push(e)},this),this._data.length>this._cap&&this._data.splice(0,this._data.length-this._cap),this},set_cap:function(e){this._cap=r.clamp(e,0)},get:function(){return this._data.slice(0)},flush:function(){this._data=[]}},r}),define("backbone",["backbonejs"],function(e){return e}),define("bus",["config","utils","jquery","underscore","backbone"],function(e,t,n,r,i){var s=t.module("bus",r.clone(i.Events));return s.off_ns=function(e,t,n){if(r.isUndefined(this._events))return this;var i=r.filter(r.keys(this._events),function(t){return r.startsWith(t,e+":")});return r.each(i,function(e){this.off(e,t,n)},this),this},s.off_for=function(e){return r.isUndefined(this._events)?this:(this.off(null,null,e),this)},s.only=function(e,t,n){return r.isUndefined(this._events)?this:(this.off(e),this.on(e,t,n),this)},n(window).on("resize",function(){s.trigger("window:resize")}),s}),define("dom",["config","utils","jquery","underscore"],function(e,t,n,r){var i=t.module("dom");return i.cache=function(e,n,i){return e=e||{},r.each(t.ensure_array(i.by_id),r.bind(function(e){this["$"+r.underscored(e)]=n.find("#"+e)},e)),r.each(t.ensure_array(i.by_class),r.bind(function(e){this["$"+r.pluralize(r.underscored(e))]=n.find("."+e)},e)),e},i.get_percent_width=function(e){var t=e.width(),n=e.parent().width();return Math.round(t/n*100)+"%"},i.get_percent_height=function(e){var t=e.height(),n=e.parent().height();return Math.round(t/n*100)+"%"},i.is_detached=function(e,t){t=t||window.document;var n=t.documentElement;return!e.closest(n).length},i.init_scrollbar=function(e){if(!e.hasClass("nano")||!e.children(".content").length)return;if(e[0].nanoscroller){var t=e[0].nanoscroller.$content;i.is_detached(t)&&(e.removeClass("has-scrollbar"),e[0].nanoscroller=null)}e.nanoScroller({alwaysVisible:!0})},i.transition_with_scrollbar=function(e,t,n){t=t||{},e.transition(t,"fast",function(){i.init_scrollbar(e),r.isFunction(n)&&n.call(e[0])})},i.is_overflowing=function(e,t){var n=t?e.closest(t):e;return e[0].scrollHeight>n[0].offsetHeight},i.is_overflowing_with_scrollbar=function(e){return i.is_overflowing(e,".nano")},i.scrollbar_scroll_top=function(e,t){var n=e.closest(".nano");if(!n.length)return;t=t||"top",n.nanoScroller({scrollTop:t})},i}),define("keys",["config","utils","jquery","underscore"],function(e,t,n,r){var i=t.module("keys"),s={},o=0,u=!1,a={enter:13,left:37,up:38,right:39,down:40,"/":191};return i.init=function(){if(u){t.log("keys module already initialized");return}t.log("initializing keys module"),n(document).on("keyup",function(e){var n=r.filter(s,function(t){return!t.paused&&t.ctrl===e.ctrlKey&&t.alt===e.altKey&&t.key===e.which});n.length&&(e.preventDefault(),e.stopPropagation()),r.each(n,function(n){var i=n?n.callback:null;r.isFunction(i)&&(t.log("executing callback for handler",n.hid),i(e))})}),u=!0},i.key_code_for=function(e){return r.isString(e)?r.has(a,e)?a[e]:e.length===1?e.toUpperCase().charCodeAt(0):null:null},i.register_handler=function(e,n){var e=e||{},u=o++;return r.isUndefined(e.key)?null:(t.log("registering key handler",u),s[u]={hid:u,ctrl:!!e.ctrl,alt:!!e.alt,key:i.key_code_for(e.key),callback:n},u)},i.unregister_handler=function(e){r.has(s,e)&&(t.log("unregistering key handler",e),delete s[e])},i.pause_handler=function(e){r.has(s,e)&&(t.log("pausing key handler",e),s[e].paused=!0)},i.resume_handler=function(e){r.has(s,e)&&(t.log("resuming key handler",e),s[e].paused=!1)},i.toggle_handler=function(e){r.has(s,e)&&(t.log("toggling key handler",e),s[e].paused=!s[e].paused)},i}),define("templates",["config","utils","jquery","underscore"],function(e,t,n,r){var i=t.module("templates"),s="/templates",o={};return i.load=function(i){r.each(t.ensure_array(i),function(t){if(o[t])return;var i=n.Deferred();o[t]=i.promise();var u=r.sprintf("%s/%s.html",s,t);e.debug&&(u+="?v="+(new Date).getTime()),n.get(u).done(function(e,t,n){i.resolve(r.template(e))}).fail(function(e,t,n){i.reject(n)})})},i.get=function(e,t){i.load(e);var r=n.Deferred();return t=t||null,o[e].done(function(e){r.resolveWith(t,[e])}).fail(function(e){r.rejectWith(t,[e])}),r.promise()},i.flush=function(){o={}},i}),define("cdn",["config","utils","jquery","underscore","backbone","bus","dom","keys","templates"],function(e,t,n,r,i,s,o,u,a){var f=t.module("cdn"),l="%s://cdnjs.cloudflare.com/ajax/libs/%s/%s/%s",c=null;return f.cache_exists=function(){return r.isArray(c)&&c.length>0},f.get_cache=function(e){var r=n.Deferred();return!e&&f.cache_exists()?r.resolve(c):f.update_cache().done(function(e){r.resolve(t.ensure_array(e))}).fail(function(e){r.resolve(t.ensure_array(c))}),r.promise()},f.update_cache=function(){var e=n.Deferred();return n.get(t.uri("cdn")).done(function(t){c=t,e.resolve(t)}).fail(function(t){e.reject(t)}),e.promise()},f.init=function(){var e=new f.FilterInput,t=new f.FilterInputView({model:e})},f.FilterInput=i.Model.extend({defaults:{value:""}}),f.FilterInputView=i.View.extend({template:"cdn-filter",el:"#markup .panel-controls",initialize:function(e){s.on("cdn:result:select mirror:focus",this.clear,this),this.model.on("change:value",this.update,this),this.render()},events:{"input #cdn":"keypress","keydown #cdn":"keypress"},keypress:function(e){e.which===u.key_code_for("up")?(s.trigger("cdn:results:prev-active"),e.preventDefault()):e.which===u.key_code_for("down")?(s.trigger("cdn:results:next-active"),e.preventDefault()):e.which===u.key_code_for("enter")&&(s.trigger("cdn:results:select-active"),e.preventDefault()),this.model.set({value:n(e.target).val()})},clear:function(){this.model.set({value:""}),this.$cdn.val("")},update:function(){var t=this,n=r.trim(this.model.get("value")).toLowerCase();f.get_cache().done(function(i){var s=r.filter(i,function(e){return!!e.name&&!!e.filename&&!!e.version&&r.str.include(e.name.toLowerCase(),n)}),o=r.sortBy(s,function(e){return r.levenshtein(n,e.name.toLowerCase())}),u=r.first(o,e.cdn_results);t.resultsView.set_filter(n),t.resultsCollection.reset(u)})},render:function(){var e=this;a.get(this.template,this).done(function(t){var n=t();this.$el.html(n),this.$cdn=this.$el.find("#cdn"),u.register_handler({ctrl:!0,key:"/"},function(t){e.$cdn.select()}),f.get_cache().done(function(t){e.$cdn.prop("disabled",!1),e.resultsCollection=new f.FilterResults([]),e.resultsView=new f.FilterResultsView({collection:e.resultsCollection})})})}}),f.FilterResult=i.Model.extend({defaults:{name:"",filename:"",version:"",active:!1}}),f.FilterResultView=i.View.extend({template:"cdn-result",tagName:"li",initialize:function(e){this.render()},events:{click:"select_lib"},get_uri:function(e){var t=this.model.toJSON(),n=e?"https":"http";return r.sprintf(l,n,t.name,t.version,t.filename)},select_lib:function(){this.$el.removeClass("active"),s.trigger("cdn:result:select",this.get_uri())},render:function(){a.get(this.template,this).done(function(e){var t=e({pkg:this.model.toJSON()});this.$el.html(t)})}}),f.FilterResults=i.Collection.extend({model:f.FilterResult}),f.FilterResultsView=i.View.extend({el:"#cdn-results",initialize:function(e){this.collection.on("reset",this.render,this),s.off_ns("cdn:results"),s.on("cdn:results:prev-active",this.prev_active,this),s.on("cdn:results:next-active",this.next_active,this),s.on("cdn:results:select-active",this.select_active,this),s.on("cdn:result:select mirror:focus",this.hide,this),this.$content=this.$el.children(".content"),this.filter="",this.render()},set_filter:function(e){this.filter=e},show:function(){this.$el.css({display:"block"});var t=o.is_overflowing_with_scrollbar(this.$ol);this.$ol.toggleClass("overflow",t);var n=this.$nomatch.is(":visible")?this.$nomatch.outerHeight(!0):Math.min(this.$ol.outerHeight()+4,e.cdn_height);this.$el.css({"max-height":r.sprintf("%spx",n)}),this.first_active(),o.transition_with_scrollbar(this.$el,{opacity:1})},hide:function(e,t){var n=this;this.$el.transition({opacity:0},"fast",function(){if(r.isFunction(t)&&t()===!0)return;this.css({display:"none"}),r.isFunction(e)&&e.call(n)})},first_active:function(){var e=this.$ol.children();e.filter(".active").removeClass(".active"),e.first().addClass("active"),this.scroll_active()},prev_active:function(){var e=this.$ol.children(),t=e.filter(".active"),n=t.first().prev();n.length&&(t.removeClass("active"),n.addClass("active")),this.scroll_active()},next_active:function(){var e=this.$ol.children(),t=e.filter(".active"),n=t.first().next();n.length?(t.removeClass("active"),n.addClass("active")):t.length||e.first().addClass("active"),this.scroll_active()},scroll_active:function(){var e=this.$ol.children().filter(".active").first();if(e.length&&this.$ol.hasClass("overflow")){var t=parseInt(this.$ol.css("padding-top"),10),n=parseInt(this.$ol.css("padding-bottom"),10),r=this.$content.outerHeight(),i=this.$content.scrollTop(),s=i+r,u=e.outerHeight(),a=i+e.position().top,f=a+u,l;f>s?(l=f-r+n,o.scrollbar_scroll_top(this.$ol,l)):a<i&&(l=a-t,o.scrollbar_scroll_top(this.$ol,l))}},select_active:function(){this.hide();var e=r.find(this._rvs,function(e){return e.$el.hasClass("active")});e instanceof f.FilterResultView&&e.select_lib()},render:function(){var e=this;if(!this.filter){this.hide(function(){e.$content.empty()},function(){return!!e.filter});return}this.$nomatch=this.$el.children(".nomatch"),this.$nomatch.toggleClass("hide",!!this.collection.models.length),this._rvs=[],this.$ol=n("<ol>"),r.each(this.collection.models,function(e){var t=new f.FilterResultView({model:e});this._rvs.push(t),this.$ol.append(t.el)},this),this.$content.html(this.$ol),this.show()}}),f}),define("codemirror",["codemirrorjs","codemirror_overlay","codemirror_search","codemirror_xml","codemirror_html","codemirror_markdown","codemirror_gfm","codemirror_css","codemirror_less","codemirror_js","codemirror_coffeescript"],function(e,t,n,r,i,s,o,u,a,f,l){return e}),define("mirrors",["config","utils","jquery","underscore","bus","codemirror","dom"],function(e,t,n,r,i,s,o){var u=t.module("mirrors"),a=[],f;u.init=function(e){r.each(e,function(e){var t=n(e),r=t.children("textarea"),o=t.children(".mode").val(),l=s.fromTextArea(r[0],{lineNumbers:!0,lineWrapping:!0,mode:o}),c={panel:t.attr("id"),$panel:t,$textarea:r,cm:l,mode:o};l.on("focus",function(){i.trigger("mirror:focus",c),f=c}),u.scrollable(c),a.push(c)}),i.on("cdn:result:select",function(e){u.add_lib_to_markup(e),u.refocus()})},u.get_by_id=function(e){var t=r.find(a,function(t){return t.panel===e});return t&&t.cm instanceof s?t:null},u.get_instance=function(e){return e&&e.cm instanceof s?e:u.get_by_id(e)},u.scrollable=function(e){var a=u.get_instance(e);if(!a)return null;var f=a.$panel.find(".CodeMirror-vscrollbar").first();f.addClass("nano").css({overflow:"visible",width:"10px"}),f.children().first().addClass("content"),o.init_scrollbar(f);var l=f.find(".pane > .slider"),c=function(){return f.height()-l.height()-4},h=function(e,t){e=e||a.cm.getScrollInfo(),t=t||c();var n=e.top/(e.height-e.clientHeight)||0;l.css({top:n*t}),f.css({display:e.height>e.clientHeight?"block":"none"})},p=function(e,t){e=e||a.cm.getScrollInfo(),t=t||c();var n=parseInt(l.css("top"),10),r=n/t;a.cm.scrollTo(null,r*(e.height-e.clientHeight))};(function(){var e,r=0,i,s,o=function(t){e=t,r=parseInt(l.css("top"),10),i=a.cm.getScrollInfo(),s=c(),n(document).on("mousemove",f),n(document).on("mouseup",u)},u=function(e){n(document).off("mousemove",f),n(document).off("mouseup",u)},f=function(n){var o=n.pageY-e.pageY;l.css("top",t.clamp(r+o,0,s)),p(i,s)};l.on("mousedown",o)})(),f.on("click",function(e){if(l.is(e.target))return;var n=e.offsetY-l.height()/2,r=t.clamp(n,0,c());l.css("top",r),p()}),a.cm.on("change",function(){f[0].nanoscroller.reset(),h()}),a.cm.on("scroll",function(){h()}),i.on("panels:resizing",function(){r.defer(function(){s.signal(a.cm,"change")})}),i.on("window:resize panels:resized",function(){r.defer(function(){u.simulate_change(a)})})};var l={markup:[{label:"HTML",mode:"htmlmixed"},{label:"Markdown",mode:"gfm"}],style:[{label:"CSS",mode:"css"},{label:"LESS",mode:"less"},{label:"SCSS",mode:"scss",cm_mode:"text/x-scss"}],script:[{label:"JavaScript",mode:"javascript"},{label:"CoffeeScript",mode:"coffeescript"},{label:"TypeScript",mode:"typescript",cm_mode:"application/typescript"},{label:"GorillaScript",mode:"gorillascript",cm_mode:"javascript"}]},c=function(e,t){return r.find(l[e],function(e){return e.mode===t||e.cm_mode===t})};return u.get_mode=function(e){var t=u.get_instance(e);return t?t.mode:null},u.set_mode=function(e,t){var n=u.get_instance(e);if(!n||!r.isString(t))return;var s=c(n.panel,t);if(!s)return;n.cm.setOption("mode",s.cm_mode||s.mode),n.mode=s.mode;var o=r.sprintf("mirrors:%s:mode",n.panel);i.trigger(o,s.mode,s.label)},u.cycle_mode=function(e){var t=u.get_instance(e),n=t.panel,i=l[n],s=u.get_mode(n);if(!i)return;var o=c(n,s),a=r.indexOf(i,o),f=i[++a%i.length];u.set_mode(n,f.mode)},u.get_theme=function(e){var t=u.get_instance(e);return t?t.cm.getOption("theme"):null},u.set_theme=function(e,t){var n=u.get_instance(e);if(!n||!r.isString(t))return;n.cm.setOption("theme",t)},u.set_theme_all=function(e){r.each(a,function(t){u.set_theme(t,e)})},u.focus=function(e){var t=u.get_instance(e);if(!t)return;t.cm.focus()},u.refocus=function(){u.focus(f)},u.search_first=function(e,t,n){var i=u.get_instance(e);if(!i||!r.isString(t)&&!r.isRegExp(t))return null;var s=i.cm.getSearchCursor(t,null,!!n);return s&&s.find()?{from:s.from(),to:s.to()}:null},u.search_last=function(e,t,n){var i=u.get_instance(e);if(!i||!r.isString(t)&&!r.isRegExp(t))return null;var s=i.cm.getSearchCursor(t,null,!!n),o;while(s&&s.find())o={from:s.from(),to:s.to()};return o||null},u.add_content_at=function(e,t,n){var i=u.get_instance(e);if(!i||!r.isString(t))return;i.cm.replaceRange(t,n)},u.add_content_start=function(e,t){if(!r.isString(t))return;return u.add_content_at(e,t+"\n",{line:0,ch:0})},u.add_content_end=function(e,t){var n=u.get_instance(e);if(!n||!r.isString(t))return;var i=n.cm.lastLine(),s=n.cm.getLine(i),o=s?"\n"+t:t;return u.add_content_at(e,o,{line:i})},u.simulate_change=function(e){var t=u.get_instance(e);if(!t)return;t.cm.replaceRange(" ",{line:0,ch:0}),t.cm.replaceRange("",{line:0,ch:0},{line:0,ch:1})},u.add_lib_to_markup=function(e){var n=u.get_by_id("markup");if(!n||!e)return;var i=n.cm.getOption("indentUnit"),s=t.resource_tag(e),o=t.resource_element_string(e),a=r.sprintf("%s%s",i,o),f,l,c,h;if(f=u.search_last(n,/<script [^>]*><\/script>/i))if(s==="script")return o=r.sprintf("\n%s%s",r.repeat(" ",f.from.ch),o),u.add_content_at(n,o,f.to);if(l=u.search_last(n,/<link [^>]*>/i))if(s==="link")return o=r.sprintf("\n%s%s",r.repeat(" ",l.from.ch),o),u.add_content_at(n,o,l.to);if(c=u.search_first(n,"</head>",!0))return o=r.sprintf("%s%s\n",r.repeat(" ",i),o),u.add_content_at(n,o,c.from);if(c=u.search_first(n,"<head>",!0))return o=r.sprintf("\n%s%s",r.repeat(" ",c.from.ch+i),o),u.add_content_at(n,o,c.to);if(h=u.search_first(n,"<html>",!0))return o=r.sprintf("\n%s%s",r.repeat(" ",h.from.ch+i),o),u.add_content_at(n,o,h.to);u.add_content_start(n,o)},u}),define("panels",["config","utils","jquery","underscore","bus","dom","mirrors"],function(e,t,n,r,i,s,o){var u=t.module("panels"),a=["layout-a","layout-b","layout-c"],f=!1,l;u.init=function(e){l=e,u.update_resize_handlers(),u.init_input_modes()},u.disable_resize_handlers=function(){u.get_all_resizers().off("mousedown").off("dblclick")},u.update_resize_handlers=function(){var o=n("body"),a=u.get_parent(),f=u.get_all_panels(),l=u.get_layout();t.log("updating panel resize handlers for",l),u.disable_resize_handlers();var p=u.get_all_resizers(),d=u.get_input_resizers(),v=u.get_master_resizer(),m=u.get_input_panels(),g=u.get_output_panel(),y=m.add(d),b,w,E,S,x,T,N,C,k,L,A,O,M,D,P,H,B,j,F;r.each(f,function(e){var t=n(e);t.data("default-width",s.get_percent_width(t)),t.data("default-height",s.get_percent_height(t)),t.data("x-offset",0),t.data("y-offset",0)});var I=function(e){b.addClass("dragging"),g.addClass("nopointer"),o.addClass(E?"ns":"ew"),n(document).on("mousemove",R),n(document).on("mouseup",q)},q=function(e){b.removeClass("dragging"),g.removeClass("nopointer"),o.removeClass("ns ew"),n(document).off("mousemove",R),n(document).off("mouseup",q),i.trigger("panels:resized")},R=function(t){if(!b)return;var n=-1*(j.left-B.left-e.panel_min),s=F.left-j.left-e.panel_min,o=-1*(j.top-B.top-e.panel_min),u=F.top-j.top-e.panel_min,a=t.pageX-H.pageX,f=t.pageY-H.pageY;a<n&&(a=n),a>s&&(a=s),f<o&&(f=o),f>u&&(f=u);var c=L+a,h=A+f,p=O-a,d=M-f,m=r.sprintf("calc(%s + %spx)",T,c),g=r.sprintf("calc(%s + %spx)",C,p),E=r.sprintf("calc(%s + %spx)",N,h),I=r.sprintf("calc(%s + %spx)",k,d);D=t.pageX,P=t.pageY;switch(l){case"layout-a":S.width(m).data("x-offset",c),x.width(g).data("x-offset",p);break;case"layout-b":w?(S.width(m).data("x-offset",c),x.width(g).data("x-offset",p)):(y.height(E).data("y-offset",h),x.height(I).data("y-offset",d));break;case"layout-c":w?(S.height(E).data("y-offset",h),x.height(I).data("y-offset",d)):(y.width(m).data("x-offset",c),x.width(g).data("x-offset",p),v.css({left:m}))}i.trigger("panels:resizing")};f.next(".panel-resizer").on("mousedown",function(e){b=n(e.target).closest(".panel-resizer"),w=r.contains(u.get_input_resizers(),b[0]),E=r.contains(u.get_horiz_resizers(),b[0]),e.preventDefault(),D=e.pageX,P=e.pageY,H=e,S=b.prevAll(".panel").first(),x=b.nextAll(".panel").first(),B=S.offset(),j=x.offset(),F={left:j.left+x.width(),top:j.top+x.height()},T=S.data("default-width"),N=S.data("default-height"),C=x.data("default-width"),k=x.data("default-height"),L=S.data("x-offset")||0,A=S.data("y-offset")||0,O=x.data("x-offset")||0,M=x.data("y-offset")||0,I(e)}).on("dblclick",function(e){b=n(e.target).closest(".panel-resizer"),w=r.contains(u.get_input_resizers(),b[0]),E=r.contains(u.get_horiz_resizers(),b[0]);var t=r.debounce(function(){i.trigger("panels:resized")},10);E?(r.each(u.get_horiz_panels(),function(e){c(e,!1,t)}),l==="layout-b"&&!w&&r.each(u.get_input_panels(),function(e){c(e,!0,t)})):(r.each(u.get_vert_panels(),function(e){h(e,!1,t)}),l==="layout-c"&&!w&&r.each(u.get_input_panels(),function(e){h(e,!0,t)}))})};var c=function(n,r,i){var s=t.ensure_jquery(n),o=s.data("default-height"),u=e.layout_time;s.data("y-offset",0).transition({height:o},u,i),r&&s.prev(".panel-resizer").transition({height:o},u,i)},h=function(n,r,i){var s=t.ensure_jquery(n),o=s.data("default-width"),a=e.layout_time;s.data("x-offset",0).transition({width:o},a,i),r&&(s.prev(".panel-resizer").transition({width:o},a,i),u.get_master_resizer().transition({left:o},a,i))};return u.init_input_modes=function(){var e=u.get_input_panels();r.each(e,function(e){var t=n(e),s=t.attr("id"),u=t.children(".mode"),a=t.find(".panel-options > .cycle");a.on("click",function(e){o.cycle_mode(s)}),i.on(r.sprintf("mirrors:%s:mode",s),function(e,t){var n=a.outerWidth();a.css({"min-width":n,"max-width":n}),u.val(e),a.text(t),r.delay(function(){a.stop().transition({"min-width":0,"max-width":300})},10)})})},u.get_all_panels=function(){return t.ensure_jquery(l)},u.get_by_id=function(e){var n=r.find(u.get_all_panels(),function(t){return t.id===e});return t.ensure_jquery(n)},u.get_parent=function(){return u.get_all_panels().first().parent()},u.get_input_panels=function(){return u.get_all_panels().filter(".input-panel")},u.get_output_panel=function(){return u.get_by_id("output")},u.get_horiz_panels=function(){var e=u.get_horiz_resizers().next(".panel"),t=e.first();return r.contains(u.get_input_panels(),t[0])&&(e=e.add(t.prevAll(".panel"))),e},u.get_vert_panels=function(){return u.get_all_panels().not(u.get_horiz_panels())},u.get_layout=function(){var e=u.get_parent();return r.find(a,function(t){return e.hasClass(t)})||r.first(a)},u.get_all_resizers=function(){return u.get_parent().find(".panel-resizer")},u.get_master_resizer=function(){return u.get_all_resizers().filter(".panel-master-resizer").first()},u.get_input_resizers=function(){var e=u.get_master_resizer();return u.get_all_resizers().not(e)},u.get_horiz_resizers=function(){return n(r.filter(u.get_all_resizers(),function(e){return!!n(e).width()}))},u.get_vert_resizers=function(){return u.get_all_resizers().not(u.get_horiz_resizers())},u.set_layout=function(t,s){if(f)return;if(!r.contains(a,t)||t===u.get_layout()){f=!1;return}f=!0;var o=u.get_parent(),l=u.get_all_panels(),c=u.get_all_resizers(),h=u.get_master_resizer(),p=u.get_input_panels(),d=u.get_output_panel(),v=r.map(p,function(e){return n(e).width()});l.removeAttr("style"),c.removeAttr("style"),h.removeAttr("style"),r.each(a,r.bind(n.fn.removeClass,o)),o.addClass(t);var m=s?0:e.layout_time,g=r.once(function(){u.update_resize_handlers(),i.trigger("panels:resized"),f=!1});if(t==="layout-a")p.css({width:"33.3%"}),l.transition({width:"25%"},m,g);else if(t==="layout-b"){r.each(v,function(e,t){p.eq(t).width(e)});var y=p.eq(1);d.transition({height:"50%"},m),y.transition({width:"34%",height:"50%"},m),p.not(y).transition({width:"33%",height:"50%"},m,g)}else t==="layout-c"&&(h.transition({left:"40%"},m),p.transition({width:"40%"},m),d.transition({right:0},m,g))},u.cycle_layout=function(){var e=u.get_parent(),t=r.some(a,function(t,n){if(e.hasClass(t)){var r=a[(n+1)%a.length];return u.set_layout(r),!0}});t||u.set_layout(r.first(a))},u}),define("popups",["config","utils","jquery","underscore","bus","templates"],function(e,t,n,r,i,s){var o=t.module("popups"),u="#popup";return o.Popup=Backbone.Model.extend({defaults:{title:"Popup"}}),o.PopupView=Backbone.View.extend({el:u,initialize:function(e){this.render()},events:{click:function(e){n(e.target).is(u)&&this.destroy()}},destroy:function(){var e=this;o.hide().always(function(){e.$el.empty(),e.stopListening(),e.undelegateEvents()})},render:function(){var e=s.get("popup",this),i=s.get(this.template,this),u=n.when(e,i);return u.done(function(e,n){var i=r.first(t.ensure_array(this)),s=i.model.toJSON(),u=n({data:s}),a=e({title:s.title,content:u});o.hide().done(function(){i.$el.html(a),o.show()})}).fail(function(e){var n=r.first(t.ensure_array(this)),i=r.sprintf('Error rendering "%s" - %s',n.template,e);console.error(i)}),this}}),o.LoginPopup=o.Popup.extend({defaults:{title:"Login"}}),o.LoginPopupView=o.PopupView.extend({template:"popup-login",initialize:function(e){this.events=r.extend({},this.events,this._events),this.constructor.__super__.initialize.apply(this,arguments)},_events:{"submit #login_form":function(e){var t=this;e.preventDefault();var i=n(e.target),s=r.sprintf("%s?%s",i.attr("action"),i.serialize()),o=i.attr("method")==="post"?"post":"get";n[o](s).done(function(e){t.destroy()}).fail(function(){t.show_invalid_login()})}},show_invalid_login:function(){}}),o.build=function(e){var t=r.sprintf("%sPopup",r.capitalize(r.camelize(e))),n=r.sprintf("%sView",t),i=o[t],s=o[n];if(!i||!s){console.error("popups.%s / popups.%s do not exist",t,n);return}var u=new i,a=new s({model:u})},o.show=function(){var e=n.Deferred(),t=n(u);return!t.length||t.is(":empty")?e.reject(!1):t.show().transition({opacity:1},function(){e.resolve(!0)}),e.promise()},o.hide=function(){var e=n.Deferred(),t=n(u);return t.length?t.transition({opacity:0},function(){t.hide(),e.resolve(!0)}):e.reject(!1),e.promise()},o}),define("router",["config","utils","jquery","underscore","backbone","bus","popups"],function(e,t,n,r,i,s,o){var u=new t.Buffer(4),a=function(){u.buf(i.history.fragment)},f=i.Router.extend({initialize:function(){this.on("route",a)},routes:{login:function(){o.build("login")}}}),l=t.module("router",new f);return l.init=function(){i.history.start({pushState:!0}),a()},l}),define("themes",["config","utils","jquery","underscore","mirrors"],function(e,t,n,r,i){var s=t.module("themes"),o=[];return s.init=function(){var t=/\/debuggerio\.(\w+)\.min\.css$/;r.each(document.styleSheets,function(e){var r=n(e.ownerNode).attr("data-href"),i=t.exec(r);i?o.push({id:i[1],stylesheet:e}):e.disabled=!0}),s.set_theme(e.default_theme)},s.get_theme=function(){var e=r.find(o,function(e,t){return!e.stylesheet.disabled});return e?e.id:null},s.set_theme=function(e){var t=r.some(o,function(t){return t.id===e});if(!t)return;i.set_theme_all(e==="dark"?"dark":"light"),r.each(o,function(t,n){t.stylesheet.disabled=t.id!==e})},s.cycle_theme=function(){var t=r.some(o,function(e,t){if(!e.stylesheet.disabled){var n=o[(t+1)%o.length].id;return s.set_theme(n),!0}});t||s.set_theme(e.default_theme)},s}),define("app",["config","utils","jquery","underscore","backbone","cdn","dom","keys","mirrors","panels","router","templates","themes"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=t.module("app");return p.App=i.View.extend({template:"app",el:"#debuggerio",initialize:function(){var e=this;s.update_cache(),this.render(function(){a.init(this.$input_panels),f.init(this.$panels),s.init(),h.init(),l.init(),this.register_keys(),this.remove_splash()})},events:{"click #theme":function(e){h.cycle_theme()},"click #layout":function(e){f.cycle_layout()},"click #github":function(t){window.open(e.github)},"click #run":"run"},run:function(){this.$iframe.css({opacity:"1"}),this.$input.submit()},register_keys:function(){var e=this;u.register_handler({ctrl:!0,key:"enter"},function(t){e.run()}),this.$panel_options.find("> input").on("input keydown",function(e){e.keyCode===u.key_code_for("enter")&&e.preventDefault()}),this.$panel_options.find("> button").on("click",function(e){e.preventDefault()}),u.init()},remove_splash:function(){var t=this;r.delay(function(){n("#loading").transition({opacity:"0"},500,function(){n(this).remove(),t.$title.transition({opacity:1},"slow")})},e.debug?0:1e3)},render:function(t){return c.get(this.template,this).done(function(n){var i=n({frame:e.frame});this.$el.html(i),o.cache(this,this.$el,{by_id:["title","markup","style","script","input","output"],by_class:["panel","input-panel","panel-options"]}),this.$iframe=this.$output.children("iframe"),r.isFunction(t)&&t.call(this)}),this}}),p}),function(){require(["jquery","app"],function(e,t){e(function(){new t.App})})}(),define("main",function(){}),function(){requirejs.config({baseUrl:"/js",paths:{jqueryjs:"//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min",underscorejs:"//cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min",backbonejs:"//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.0/backbone-min",codemirrorjs:"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.20.0/codemirror.min",ui:"//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min",transit:"//cdnjs.cloudflare.com/ajax/libs/jquery.transit/0.9.9/jquery.transit.min",nano:"//cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.7.4/jquery.nanoscroller.min",string:"//cdnjs.cloudflare.com/ajax/libs/underscore.string/2.3.3/underscore.string.min",inflection:"plugins/underscore.inflection.min",codemirror_overlay:"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.20.0/addon/mode/overlay.min",codemirror_search:"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.20.0/addon/search/searchcursor.min",codemirror_xml:"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.20.0/mode/xml/xml.min",codemirror_html:"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.20.0/mode/htmlmixed/htmlmixed.min",codemirror_markdown:"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.20.0/mode/markdown/markdown.min",codemirror_gfm:"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.20.0/mode/gfm/gfm.min",codemirror_css:"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.20.0/mode/css/css.min",codemirror_less:"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.20.0/mode/less/less.min",codemirror_js:"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.20.0/mode/javascript/javascript.min",codemirror_coffeescript:"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.20.0/mode/coffeescript/coffeescript.min",jasminejs:"//cdnjs.cloudflare.com/ajax/libs/jasmine/1.3.1/jasmine",jasmine_html:"//cdnjs.cloudflare.com/ajax/libs/jasmine/1.3.1/jasmine-html",jasmine_jquery:"plugins/jasmine-jquery.min",jquery:"libs/jquery",underscore:"libs/underscore",backbone:"libs/backbone",codemirror:"libs/codemirror",jasmine:"libs/jasmine"},shim:{jqueryjs:{exports:"$"},underscorejs:{exports:"_"},backbonejs:{deps:["jqueryjs","underscorejs"],exports:"Backbone"},codemirrorjs:{exports:"CodeMirror"},jasminejs:{exports:"jasmine"},jasmine_html:{deps:["jasminejs"]},jasmine_jquery:{deps:["jasminejs","jquery"]},ui:{deps:["jqueryjs"],exports:"$.ui"},transit:{deps:["jqueryjs"],exports:"$.transit"},nano:{deps:["jqueryjs"],exports:"$.fn.nanoScroller"},string:{deps:["underscorejs"],exports:"_.str"},inflection:{deps:["underscorejs"]},codemirror_overlay:{deps:["codemirrorjs"]},codemirror_search:{deps:["codemirrorjs"]},codemirror_xml:{deps:["codemirrorjs"]},codemirror_html:{deps:["codemirrorjs"]},codemirror_markdown:{deps:["codemirrorjs"]},codemirror_gfm:{deps:["codemirrorjs","codemirror_overlay","codemirror_markdown"]},codemirror_css:{deps:["codemirrorjs"]},codemirror_less:{deps:["codemirrorjs"]},codemirror_js:{deps:["codemirrorjs"]},codemirror_coffeescript:{deps:["codemirrorjs"]}}})}(),define("require.config.js",function(){});